(this["webpackJsonpinstant-survey"]=this["webpackJsonpinstant-survey"]||[]).push([[0],{30:function(e,t,n){e.exports={root:"Answer_root__2pq4A",animate:"Answer_animate__3cNGN",button:"Answer_button__3llNr",bar:"Answer_bar__CHkP2",item:"Answer_item__3bULz",my:"Answer_my__RC-Cs",answer:"Answer_answer__3QepJ",count:"Answer_count__3DShc"}},47:function(e,t,n){e.exports={root:"InstantSurvey_root__1vFpt",title:"InstantSurvey_title__3RpJq",answers:"InstantSurvey_answers__1ZJMl",input_wrap:"InstantSurvey_input_wrap__1aN55"}},60:function(e,t,n){e.exports={root:"ResponsiveText_root__1Ds0_",dummy:"ResponsiveText_dummy__1f85y"}},63:function(e,t,n){e.exports={cog:"Main_cog__1wdKd"}},75:function(e,t,n){e.exports={root:"AddSurvey_root__3IKt1",item:"AddSurvey_item__35jFS"}},80:function(e){e.exports=JSON.parse('{"firebase":{"apiKey":"AIzaSyDS1mhNTsLekzQB7t1q3E52G8Wy4sDiSA4","authDomain":"instant-survey-f7f4c.firebaseapp.com","projectId":"instant-survey-f7f4c","storageBucket":"instant-survey-f7f4c.appspot.com","messagingSenderId":"934201169374","appId":"1:934201169374:web:3f8744be20f5ca255cf94f"}}')},89:function(e,t,n){},96:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(23),s=n.n(c),i=(n(89),n(100)),u=n(82),o=n(27),l=n(7),j=n(16),b=n.n(j),d=n(36),f=n(3),O=n(17),v=Object(r.createContext)({database:void 0,userId:""}),m=n(40),p=Object(O.b)({key:"containerWidthState",default:0}),h=(Object(O.b)({key:"scrollLeftState",default:0}),Object(O.b)({key:"tickState",default:0}),Object(O.b)({key:"activeIdState",default:""}),Object(O.b)({key:"keywordState",default:""}),Object(O.b)({key:"maxContentWidthState",default:0}),Object(O.b)({key:"jsonPathsState",default:[]}),Object(O.b)({key:"hoverState",default:""}),Object(O.b)({key:"answersHeightState",default:{}})),x=n(60),w=n.n(x),y=n(4);var _=function(e){var t=e.text,n=e.fontSizes,a=Object(m.a)(),c=Object(f.a)(a,2),s=c[0],i=c[1],u=Object(r.useRef)(null),o=Object(r.useState)(""),l=Object(f.a)(o,2),j=l[0],b=l[1];return Object(r.useLayoutEffect)((function(){if(u.current){var e=document.createElement("div");u.current.appendChild(e),e.innerText=t;var r=n.find((function(t){return e.style.fontSize=t,i.width>e.getBoundingClientRect().width}));u.current.innerHTML="",b(r||n[n.length-1])}}),[i.width,u,t,n]),Object(y.jsxs)("div",{ref:s,className:w.a.root,children:[Object(y.jsx)("div",{style:{fontSize:j},children:t}),Object(y.jsx)("div",{className:w.a.dummy,ref:u})]})},g=n(30),S=n.n(g);function k(e){var t=e.data,n=e.onClick,a=Object(m.a)(),c=Object(f.a)(a,2),s=c[0],i=c[1],j=Object(O.d)(h);Object(r.useLayoutEffect)((function(){return j((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(o.a)({},t.answer,i.height))})),function(){j((function(e){var n=Object(l.a)({},e);return delete n[t.answer],n}))}}),[t.answer,i.height,j]);var b=Object(O.c)(p),d=Object(r.useRef)(null);return Object(r.useLayoutEffect)((function(){d.current&&d.current.classList.add(S.a.animate)}),[d]),Object(y.jsx)("div",{ref:d,className:S.a.root,style:{transform:"translateY(".concat(t.top,"px)")},children:Object(y.jsx)("div",{ref:s,children:Object(y.jsxs)(u.a,{className:S.a.button,onClick:function(){n()},block:!0,children:[Object(y.jsx)(z,{width:b,data:t}),Object(y.jsx)("div",{className:S.a.bar,style:{width:"".concat(100*t.percent,"%")},children:Object(y.jsx)(z,{width:b,data:t})})]})})})}var N=44,A=50,C=16,I=["2rem","1.5rem","1.25rem"];function z(e){var t=e.width,n=e.data;return Object(y.jsxs)("div",{className:S.a.item,style:{width:t,padding:"0 ".concat(C,"px")},children:[n.myAnswer&&Object(y.jsx)("div",{className:S.a.my,style:{flexBasis:N},children:"\ud83d\udc4d"}),Object(y.jsx)("div",{className:S.a.answer,style:{flexBasis:t-(n.myAnswer?N:0)-A-2*C},children:Object(y.jsx)(_,{text:n.answer,fontSizes:I})}),Object(y.jsxs)("div",{className:S.a.count,style:{flexBasis:A},children:["".concat(n.count,"\uba85"),Object(y.jsx)("br",{}),"".concat(~~(100*n.percent),"%")]})]})}var B=a.a.memo(k),L=n(98);var M=function(e){var t=e.text,n=Object(r.useMemo)((function(){return(t||"").trim().split(/\s+/).map((function(e,t,n){return Object(y.jsxs)(r.Fragment,{children:[Object(y.jsx)("span",{style:{whiteSpace:"nowrap"},children:e}),t<n.length-1?" ":""]},t)}))}),[t]);return Object(y.jsx)(y.Fragment,{children:n})},q=n(47),E=n.n(q);function R(){var e=function(){var e,t=Object(r.useContext)(v),n=t.database,a=t.userId,c=Object(r.useState)({}),s=Object(f.a)(c,2),i=s[0],u=s[1];Object(r.useEffect)((function(){null===n||void 0===n||n.ref("/current-survey").on("value",(function(e){var t=e.val();u(t)}))}),[n]);var o=null===i||void 0===i||null===(e=i.responses)||void 0===e?void 0:e[a],j=Object(r.useCallback)((function(e){null===n||void 0===n||n.ref("/current-survey/responses/".concat(a)).set(o===e?null:e)}),[n,a,o]),O=Object(r.useCallback)(function(){var e=Object(d.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([null===n||void 0===n?void 0:n.ref("/current-survey/answers").push(t),null===n||void 0===n?void 0:n.ref("/current-survey/responses/".concat(a)).set(t)]);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[n,a]);return Object(r.useMemo)((function(){return Object(l.a)(Object(l.a)({},i),{},{myId:a,myAnswer:o,selectAnswer:j,submitNewAnswer:O})}),[i,a,o,j,O])}(),t=e.question,n=e.answers,a=e.responses,c=e.myAnswer,s=e.selectAnswer,i=e.submitNewAnswer,j=Object(r.useState)(""),x=Object(f.a)(j,2),w=x[0],_=x[1],g=!w||Object.values(n||{}).includes(w),S=Object(r.useState)(0),k=Object(f.a)(S,2),N=k[0],A=k[1],C=function(){var e=Object(d.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),i(w),A((function(e){return e+1}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=Object(O.c)(h),z=Object(r.useMemo)((function(){var e=Object.values(n||{}),t=0,r=e.reduce((function(e,t){return Object(l.a)(Object(l.a)({},e),{},Object(o.a)({},t,{answer:t,count:0}))}),{});Object.entries(a||{}).forEach((function(e){var n=Object(f.a)(e,2)[1];n in r&&(t++,r[n].count++)}));var s=0;return r=Object.values(r).sort((function(e,t){return(null===e||void 0===e?void 0:e.count)===(null===t||void 0===t?void 0:t.count)?0:(null===e||void 0===e?void 0:e.count)<(null===t||void 0===t?void 0:t.count)?1:-1})).reduce((function(e,n,r){var a=s;return s=s+(I[n.answer]||0)+10,Object(l.a)(Object(l.a)({},e),{},Object(o.a)({},n.answer,Object(l.a)(Object(l.a)({},n),{},{rank:r,percent:n.count/Math.max(t,1),top:a,myAnswer:c===n.answer})))}),{}),[e.map((function(e){return Object(l.a)({answer:e},r[e])})),s]}),[c,n,a,I]),q=Object(f.a)(z,2),R=q[0],T=q[1],D=Object(O.d)(p),F=Object(m.a)(),J=Object(f.a)(F,2),P=J[0],H=J[1];return Object(r.useLayoutEffect)((function(){D(H.width)}),[D,H.width]),Object(y.jsxs)("div",{className:E.a.root,ref:P,children:[Object(y.jsx)("h1",{className:E.a.title,children:Object(y.jsx)(M,{text:t})}),Object(y.jsx)("div",{className:E.a.answers,style:{height:T},children:R.map((function(e,t){return Object(y.jsx)(B,{data:e,onClick:function(){s(e.answer)}},t)}))}),Object(y.jsx)("form",{onSubmit:C,children:Object(y.jsxs)("div",{className:E.a.input_wrap,children:[Object(y.jsx)(L.a,{type:"text",size:"large",onChange:function(e){_(e.target.value.trim())},placeholder:"\ucd94\uac00 \uc758\uacac\uc744 \ub0a8\uaca8\uc8fc\uc138\uc694.",allowClear:!0},N),Object(y.jsx)(u.a,{size:"large",type:"primary",htmlType:"submit",disabled:g,children:"\ud655\uc778"})]})})]})}var T=function(){return Object(y.jsx)(O.a,{children:Object(y.jsx)(R,{})})},D=n(35),F=n(75),J=n.n(F);var P=function(e){var t=Object(r.useContext)(v).database,n=Object(r.useState)(""),a=Object(f.a)(n,2),c=a[0],s=a[1],i=Object(r.useState)([]),o=Object(f.a)(i,2),j=o[0],O=o[1],m=Object(r.useRef)(0),p=Object(r.useMemo)((function(){return 0===j.filter((function(e){return!e})).length?[].concat(Object(D.a)(j),[{seq:m.current++,value:""}]):j}),[j,m]),h=Object(r.useMemo)((function(){return{question:c,answers:j.map((function(e){return e.value})).filter(Boolean).filter((function(e,t,n){return n.indexOf(e)===t}))}}),[c,j]),x=function(){var e=Object(d.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===t||void 0===t?void 0:t.ref("/current-survey").set(Object(l.a)(Object(l.a)({},h),{},{createdAt:(new Date).toISOString()}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(y.jsxs)("div",{className:J.a.root,children:[Object(y.jsx)(L.a,{type:"text",onChange:function(e){s(e.target.value.trim())},addonBefore:"Q",size:"large"}),p.map((function(e,t){return Object(y.jsx)("div",{children:Object(y.jsx)(L.a.Group,{compact:!0,children:Object(y.jsx)(L.a,{type:"text",onChange:function(n){O((function(r){return[].concat(Object(D.a)(r.slice(0,t)),[{seq:e.seq,value:n.target.value.trim()}],Object(D.a)(r.slice(t+1)))}))},addonBefore:t+1,size:"large"})})},e.seq)})),Object(y.jsx)(u.a,{type:"primary",size:"large",onClick:x,disabled:!(h.question&&h.answers.length>1),block:!0,children:"submit"})]})},H=n(63),G=n.n(H);var K=function(){return Object(y.jsx)("div",{className:"container",children:Object(y.jsxs)("div",{className:G.a.root,children:[Object(y.jsx)(T,{}),window.location.search&&Object(y.jsx)(i.a,{destroyTooltipOnHide:!0,placement:"bottomRight",content:Object(y.jsx)(P,{}),trigger:"click",children:Object(y.jsx)(u.a,{type:"link",className:G.a.cog,children:Object(y.jsx)("i",{className:"material-icons",children:"settings"})})})]})})},Q=n(79),W=(n(92),n(80));var U=function(e){var t=e.children,n=Object(r.useState)(),a=Object(f.a)(n,2),c=a[0],s=a[1],i=Object(r.useState)((function(){var e=localStorage.getItem("user-id");return e||(e=Math.random().toString(36).substr(-8),localStorage.setItem("user-id",e)),e})),u=Object(f.a)(i,1)[0];return Object(r.useEffect)((function(){var e=Q.a.initializeApp(W.firebase);s(e.database())}),[]),c?Object(y.jsx)(v.Provider,{value:{database:c,userId:u},children:t}):null};var Y=function(){return Object(y.jsx)(U,{children:Object(y.jsx)(K,{})})},Z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,101)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};s.a.render(Object(y.jsx)(a.a.StrictMode,{children:Object(y.jsx)(Y,{})}),document.getElementById("root")),Z()}},[[96,1,2]]]);
//# sourceMappingURL=main.8ca51cbe.chunk.js.map
(this["webpackJsonpinstant-survey"]=this["webpackJsonpinstant-survey"]||[]).push([[0],{111:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(23),s=n.n(c),i=(n(96),n(115)),o=n(89),u=n(27),l=n(7),j=n(16),d=n.n(j),b=n(35),f=n(4),O=n(17),v=Object(a.createContext)({database:void 0,userId:""}),m=n(40),p=Object(O.b)({key:"containerWidthState",default:0}),h=(Object(O.b)({key:"scrollLeftState",default:0}),Object(O.b)({key:"tickState",default:0}),Object(O.b)({key:"activeIdState",default:""}),Object(O.b)({key:"keywordState",default:""}),Object(O.b)({key:"maxContentWidthState",default:0}),Object(O.b)({key:"jsonPathsState",default:[]}),Object(O.b)({key:"hoverState",default:""}),Object(O.b)({key:"answersHeightState",default:{}})),x=n(62),w=n.n(x),y=n(3);var _=function(e){var t=e.text,n=e.fontSizes,r=Object(m.a)(),c=Object(f.a)(r,2),s=c[0],i=c[1],o=Object(a.useRef)(null),u=Object(a.useState)(""),l=Object(f.a)(u,2),j=l[0],d=l[1];return Object(a.useLayoutEffect)((function(){if(o.current){var e=document.createElement("div");o.current.appendChild(e),e.innerText=t;var a=n.find((function(t){return e.style.fontSize=t,i.width>e.getBoundingClientRect().width}));o.current.innerHTML="",d(a||n[n.length-1])}}),[i.width,o,t,n]),Object(y.jsxs)("div",{ref:s,className:w.a.root,children:[Object(y.jsx)("div",{style:{fontSize:j},children:t}),Object(y.jsx)("div",{className:w.a.dummy,ref:o})]})},S=n(30),g=n.n(S);function k(e){var t=e.data,n=e.onClick,r=e.onRemove,c=Object(m.a)(),s=Object(f.a)(c,2),i=s[0],j=s[1],d=Object(O.d)(h);Object(a.useLayoutEffect)((function(){return d((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(u.a)({},t.answer,j.height))})),function(){d((function(e){var n=Object(l.a)({},e);return delete n[t.answer],n}))}}),[t.answer,j.height,d]);var b=Object(O.c)(p),v=Object(a.useRef)(null);return Object(a.useLayoutEffect)((function(){v.current&&v.current.classList.add(g.a.animate)}),[v]),Object(y.jsx)("div",{ref:v,className:g.a.root,style:{transform:"translateY(".concat(t.top,"px)")},children:Object(y.jsx)("div",{ref:i,children:Object(y.jsxs)(o.a,{className:g.a.button,onClick:function(){n()},block:!0,children:[Object(y.jsx)(z,{width:b,data:t,onClick:r}),Object(y.jsx)("div",{className:g.a.bar,style:{width:"".concat(100*t.percent,"%")},children:Object(y.jsx)(z,{width:b,data:t})})]})})})}var N=44,A=50,C=16,I=["2rem","1.5rem","1.25rem"];function z(e){var t=e.width,n=e.data,a=e.onClick;return Object(y.jsxs)("div",{className:g.a.item,style:{width:t,padding:"0 ".concat(C,"px")},children:[n.myAnswer&&Object(y.jsx)("div",{className:g.a.my,style:{flexBasis:N},children:"\ud83d\udc4d"}),Object(y.jsx)("div",{className:g.a.answer,style:{flexBasis:t-(n.myAnswer?N:0)-A-2*C},children:Object(y.jsx)(_,{text:n.answer,fontSizes:I})}),Object(y.jsxs)("div",{className:g.a.count,style:{flexBasis:A},onClick:function(e){window.location.search.match(/admin/)&&"function"===typeof a&&(e.stopPropagation(),a())},children:["".concat(n.count,"\uba85"),Object(y.jsx)("br",{}),"".concat(~~(100*n.percent),"%")]})]})}var q=r.a.memo(k),R=n(113);var T=function(e){var t=e.text,n=Object(a.useMemo)((function(){return(t||"").trim().split(/\s+/).map((function(e,t,n){return Object(y.jsxs)(a.Fragment,{children:[Object(y.jsx)("span",{style:{whiteSpace:"nowrap"},children:e}),t<n.length-1?" ":""]},t)}))}),[t]);return Object(y.jsx)(y.Fragment,{children:n})},L=n(38),E=n.n(L);function M(){var e=function(){var e,t=Object(a.useContext)(v),n=t.database,r=t.userId,c=Object(a.useState)({}),s=Object(f.a)(c,2),i=s[0],o=s[1];Object(a.useEffect)((function(){null===n||void 0===n||n.ref("/current-survey").on("value",(function(e){var t=e.val();o(t)}))}),[n]);var u=null===i||void 0===i||null===(e=i.responses)||void 0===e?void 0:e[r],j=Object(a.useCallback)((function(e){null===n||void 0===n||n.ref("/current-survey/responses/".concat(r)).set(u===e?null:e)}),[n,r,u]),O=Object(a.useCallback)(function(){var e=Object(b.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([null===n||void 0===n?void 0:n.ref("/current-survey/answers").push(t),null===n||void 0===n?void 0:n.ref("/current-survey/responses/".concat(r)).set(t)]);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[n,r]),m=Object(a.useCallback)((function(e){var t=Object.values((null===i||void 0===i?void 0:i.answers)||{});null===n||void 0===n||n.ref("/current-survey/answers").set(t.filter((function(t){return t!==e})))}),[n,i]);return Object(a.useMemo)((function(){return Object(l.a)(Object(l.a)({},i),{},{myId:r,myAnswer:u,selectAnswer:j,submitNewAnswer:O,removeAnswer:m})}),[i,r,u,j,O,m])}(),t=e.question,n=e.answers,r=e.responses,c=e.myAnswer,s=e.selectAnswer,i=e.submitNewAnswer,j=Object(a.useState)(""),x=Object(f.a)(j,2),w=x[0],_=x[1],S=!w||Object.values(n||{}).includes(w),g=Object(a.useState)(0),k=Object(f.a)(g,2),N=k[0],A=k[1],C=function(){var e=Object(b.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),i(w),_(""),A((function(e){return e+1}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=Object(O.c)(h),z=Object(a.useMemo)((function(){var e=Object.values(n||{}),t=0,a=e.reduce((function(e,t){return Object(l.a)(Object(l.a)({},e),{},Object(u.a)({},t,{answer:t,count:0}))}),{});Object.entries(r||{}).forEach((function(e){var n=Object(f.a)(e,2)[1];n in a&&(t++,a[n].count++)}));var s=0;return a=Object.values(a).sort((function(e,t){return(null===e||void 0===e?void 0:e.count)===(null===t||void 0===t?void 0:t.count)?0:(null===e||void 0===e?void 0:e.count)<(null===t||void 0===t?void 0:t.count)?1:-1})).reduce((function(e,n,a){var r=s;return s=s+(I[n.answer]||0)+10,Object(l.a)(Object(l.a)({},e),{},Object(u.a)({},n.answer,Object(l.a)(Object(l.a)({},n),{},{rank:a,percent:n.count/Math.max(t,1),top:r,myAnswer:c===n.answer})))}),{}),[e.map((function(e){return Object(l.a)({answer:e},a[e])})),t,s]}),[c,n,r,I]),L=Object(f.a)(z,3),M=L[0],B=L[1],D=L[2],F=Object(O.d)(p),P=Object(m.a)(),H=Object(f.a)(P,2),J=H[0],K=H[1];return Object(a.useLayoutEffect)((function(){F(K.width)}),[F,K.width]),Object(y.jsx)("div",{className:E.a.root,ref:J,children:Object(y.jsxs)("div",{className:E.a.inner,children:[Object(y.jsx)("h1",{className:E.a.title,children:Object(y.jsx)(T,{text:t})}),Object(y.jsxs)("div",{className:E.a.total_count,children:["\uc804\uccb4 ",B,"\uba85"]}),Object(y.jsx)("div",{className:E.a.answers,style:{height:D},children:M.map((function(e,t){return Object(y.jsx)(q,{data:e,onClick:function(){s(e.answer)},onRemove:function(){}},t)}))}),Object(y.jsx)("form",{onSubmit:C,children:Object(y.jsxs)("div",{className:E.a.input_wrap,children:[Object(y.jsx)(R.a,{type:"text",size:"large",onChange:function(e){_(e.target.value.trim())},placeholder:"\ucd94\uac00 \uc758\uacac\uc744 \ub0a8\uaca8\uc8fc\uc138\uc694.",allowClear:!0},N),Object(y.jsx)(o.a,{size:"large",type:"primary",htmlType:"submit",disabled:S,children:"\ud655\uc778"})]})})]})})}var B=function(){return Object(y.jsx)(O.a,{children:Object(y.jsx)(M,{})})},D=n(44),F=n(65),P=n.n(F),H=R.a.TextArea;var J=function(e){var t=Object(a.useContext)(v).database,n=Object(a.useState)(0),r=Object(f.a)(n,2),c=r[0],s=r[1],i=function(){var e=Object(b.a)(d.a.mark((function e(n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,null===t||void 0===t?void 0:t.ref("/current-survey").set(Object(l.a)(Object(l.a)({},O),{},{createdAt:(new Date).toISOString()}));case 3:m({question:"",answers:[""]}),s((function(e){return e+1}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=Object(a.useState)({question:"",answers:[""]}),j=Object(f.a)(u,2),O=j[0],m=j[1];return Object(y.jsx)("div",{className:P.a.root,children:Object(y.jsxs)("form",{onSubmit:i,children:[Object(y.jsx)(H,{className:P.a.textarea,onChange:function(e){var t=e.target.value.split("\n").map((function(e){return e.trim()})).filter(Boolean).filter((function(e,t,n){return n.indexOf(e)===t})),n=Object(D.a)(t),a=n[0],r=n.slice(1);m({question:a,answers:r})},autoSize:{minRows:5},spellCheck:!1},c),Object(y.jsx)(o.a,{type:"primary",size:"large",htmlType:"submit",disabled:!(O.question&&O.answers.length>1),block:!0,children:"submit"})]})})},K=n(81),Q=n.n(K),W=n(82),G=n.n(W);var U=function(){var e=window.location.href.replace(/&admin/,"").replace(/\?admin$/,"").replace(/\?admin/,"?");return Object(y.jsx)("div",{className:G.a.root,children:Object(y.jsx)(Q.a,{value:e})})},Y=n(59),Z=n.n(Y);var $=function(){return Object(y.jsx)("div",{className:"container",children:Object(y.jsxs)("div",{className:Z.a.root,children:[Object(y.jsx)(B,{}),Object(y.jsx)(i.a,{destroyTooltipOnHide:!0,placement:"bottomRight",content:Object(y.jsx)(U,{}),trigger:"click",children:Object(y.jsx)(o.a,{type:"link",className:Z.a.qrcode,children:Object(y.jsx)("i",{className:"material-icons",children:"qr_code_2"})})}),window.location.search.match(/admin/)&&Object(y.jsx)(i.a,{destroyTooltipOnHide:!0,placement:"topRight",content:Object(y.jsx)(J,{}),trigger:"click",children:Object(y.jsx)(o.a,{type:"link",className:Z.a.cog,children:Object(y.jsx)("i",{className:"material-icons",children:"settings"})})})]})})},V=n(86),X=(n(107),n(87));var ee=function(e){var t=e.children,n=Object(a.useState)(),r=Object(f.a)(n,2),c=r[0],s=r[1],i=Object(a.useState)((function(){var e=localStorage.getItem("user-id");return e||(e=Math.random().toString(36).substr(-8),localStorage.setItem("user-id",e)),e})),o=Object(f.a)(i,1)[0];return Object(a.useEffect)((function(){var e=V.a.initializeApp(X.firebase);s(e.database())}),[]),c?Object(y.jsx)(v.Provider,{value:{database:c,userId:o},children:t}):null};var te=function(){return Object(y.jsx)(ee,{children:Object(y.jsx)($,{})})},ne=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,116)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))};s.a.render(Object(y.jsx)(r.a.StrictMode,{children:Object(y.jsx)(te,{})}),document.getElementById("root")),ne()},30:function(e,t,n){e.exports={root:"Answer_root__2pq4A",animate:"Answer_animate__3cNGN",button:"Answer_button__3llNr",bar:"Answer_bar__CHkP2",item:"Answer_item__3bULz",my:"Answer_my__RC-Cs",answer:"Answer_answer__3QepJ",count:"Answer_count__3DShc"}},38:function(e,t,n){e.exports={root:"InstantSurvey_root__1vFpt",inner:"InstantSurvey_inner__2F1OO",title:"InstantSurvey_title__3RpJq",answers:"InstantSurvey_answers__1ZJMl",total_count:"InstantSurvey_total_count__2kmka",input_wrap:"InstantSurvey_input_wrap__1aN55"}},59:function(e,t,n){e.exports={qrcode:"Main_qrcode__30a1k",cog:"Main_cog__1wdKd"}},62:function(e,t,n){e.exports={root:"ResponsiveText_root__1Ds0_",dummy:"ResponsiveText_dummy__1f85y"}},65:function(e,t,n){e.exports={root:"AddSurvey_root__3IKt1",item:"AddSurvey_item__35jFS"}},82:function(e,t,n){e.exports={root:"SiteUrlQrCode_root__9zKH5"}},87:function(e){e.exports=JSON.parse('{"firebase":{"apiKey":"AIzaSyDS1mhNTsLekzQB7t1q3E52G8Wy4sDiSA4","authDomain":"instant-survey-f7f4c.firebaseapp.com","projectId":"instant-survey-f7f4c","storageBucket":"instant-survey-f7f4c.appspot.com","messagingSenderId":"934201169374","appId":"1:934201169374:web:3f8744be20f5ca255cf94f"}}')},96:function(e,t,n){}},[[111,1,2]]]);
//# sourceMappingURL=main.593c955e.chunk.js.map
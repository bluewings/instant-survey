(this["webpackJsonpinstant-survey"]=this["webpackJsonpinstant-survey"]||[]).push([[0],{110:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(23),s=n.n(r),i=(n(95),n(114)),o=n(88),u=n(27),l=n(7),j=n(16),b=n.n(j),d=n(36),f=n(4),O=n(17),v=Object(a.createContext)({database:void 0,userId:""}),m=n(41),p=Object(O.b)({key:"containerWidthState",default:0}),h=(Object(O.b)({key:"scrollLeftState",default:0}),Object(O.b)({key:"tickState",default:0}),Object(O.b)({key:"activeIdState",default:""}),Object(O.b)({key:"keywordState",default:""}),Object(O.b)({key:"maxContentWidthState",default:0}),Object(O.b)({key:"jsonPathsState",default:[]}),Object(O.b)({key:"hoverState",default:""}),Object(O.b)({key:"answersHeightState",default:{}})),x=n(61),y=n.n(x),w=n(3);var _=function(e){var t=e.text,n=e.fontSizes,c=Object(m.a)(),r=Object(f.a)(c,2),s=r[0],i=r[1],o=Object(a.useRef)(null),u=Object(a.useState)(""),l=Object(f.a)(u,2),j=l[0],b=l[1];return Object(a.useLayoutEffect)((function(){if(o.current){var e=document.createElement("div");o.current.appendChild(e),e.innerText=t;var a=n.find((function(t){return e.style.fontSize=t,i.width>e.getBoundingClientRect().width}));o.current.innerHTML="",b(a||n[n.length-1])}}),[i.width,o,t,n]),Object(w.jsxs)("div",{ref:s,className:y.a.root,children:[Object(w.jsx)("div",{style:{fontSize:j},children:t}),Object(w.jsx)("div",{className:y.a.dummy,ref:o})]})},g=n(30),S=n.n(g);function k(e){var t=e.data,n=e.onClick,c=Object(m.a)(),r=Object(f.a)(c,2),s=r[0],i=r[1],j=Object(O.d)(h);Object(a.useLayoutEffect)((function(){return j((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(u.a)({},t.answer,i.height))})),function(){j((function(e){var n=Object(l.a)({},e);return delete n[t.answer],n}))}}),[t.answer,i.height,j]);var b=Object(O.c)(p),d=Object(a.useRef)(null);return Object(a.useLayoutEffect)((function(){d.current&&d.current.classList.add(S.a.animate)}),[d]),Object(w.jsx)("div",{ref:d,className:S.a.root,style:{transform:"translateY(".concat(t.top,"px)")},children:Object(w.jsx)("div",{ref:s,children:Object(w.jsxs)(o.a,{className:S.a.button,onClick:function(){n()},block:!0,children:[Object(w.jsx)(q,{width:b,data:t}),Object(w.jsx)("div",{className:S.a.bar,style:{width:"".concat(100*t.percent,"%")},children:Object(w.jsx)(q,{width:b,data:t})})]})})})}var N=44,A=50,C=16,I=["2rem","1.5rem","1.25rem"];function q(e){var t=e.width,n=e.data;return Object(w.jsxs)("div",{className:S.a.item,style:{width:t,padding:"0 ".concat(C,"px")},children:[n.myAnswer&&Object(w.jsx)("div",{className:S.a.my,style:{flexBasis:N},children:"\ud83d\udc4d"}),Object(w.jsx)("div",{className:S.a.answer,style:{flexBasis:t-(n.myAnswer?N:0)-A-2*C},children:Object(w.jsx)(_,{text:n.answer,fontSizes:I})}),Object(w.jsxs)("div",{className:S.a.count,style:{flexBasis:A},children:["".concat(n.count,"\uba85"),Object(w.jsx)("br",{}),"".concat(~~(100*n.percent),"%")]})]})}var z=c.a.memo(k),M=n(112);var B=function(e){var t=e.text,n=Object(a.useMemo)((function(){return(t||"").trim().split(/\s+/).map((function(e,t,n){return Object(w.jsxs)(a.Fragment,{children:[Object(w.jsx)("span",{style:{whiteSpace:"nowrap"},children:e}),t<n.length-1?" ":""]},t)}))}),[t]);return Object(w.jsx)(w.Fragment,{children:n})},L=n(39),T=n.n(L);function E(){var e=function(){var e,t=Object(a.useContext)(v),n=t.database,c=t.userId,r=Object(a.useState)({}),s=Object(f.a)(r,2),i=s[0],o=s[1];Object(a.useEffect)((function(){null===n||void 0===n||n.ref("/current-survey").on("value",(function(e){var t=e.val();o(t)}))}),[n]);var u=null===i||void 0===i||null===(e=i.responses)||void 0===e?void 0:e[c],j=Object(a.useCallback)((function(e){null===n||void 0===n||n.ref("/current-survey/responses/".concat(c)).set(u===e?null:e)}),[n,c,u]),O=Object(a.useCallback)(function(){var e=Object(d.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([null===n||void 0===n?void 0:n.ref("/current-survey/answers").push(t),null===n||void 0===n?void 0:n.ref("/current-survey/responses/".concat(c)).set(t)]);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[n,c]);return Object(a.useMemo)((function(){return Object(l.a)(Object(l.a)({},i),{},{myId:c,myAnswer:u,selectAnswer:j,submitNewAnswer:O})}),[i,c,u,j,O])}(),t=e.question,n=e.answers,c=e.responses,r=e.myAnswer,s=e.selectAnswer,i=e.submitNewAnswer,j=Object(a.useState)(""),x=Object(f.a)(j,2),y=x[0],_=x[1],g=!y||Object.values(n||{}).includes(y),S=Object(a.useState)(0),k=Object(f.a)(S,2),N=k[0],A=k[1],C=function(){var e=Object(d.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),i(y),_(""),A((function(e){return e+1}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=Object(O.c)(h),q=Object(a.useMemo)((function(){var e=Object.values(n||{}),t=0,a=e.reduce((function(e,t){return Object(l.a)(Object(l.a)({},e),{},Object(u.a)({},t,{answer:t,count:0}))}),{});Object.entries(c||{}).forEach((function(e){var n=Object(f.a)(e,2)[1];n in a&&(t++,a[n].count++)}));var s=0;return a=Object.values(a).sort((function(e,t){return(null===e||void 0===e?void 0:e.count)===(null===t||void 0===t?void 0:t.count)?0:(null===e||void 0===e?void 0:e.count)<(null===t||void 0===t?void 0:t.count)?1:-1})).reduce((function(e,n,a){var c=s;return s=s+(I[n.answer]||0)+10,Object(l.a)(Object(l.a)({},e),{},Object(u.a)({},n.answer,Object(l.a)(Object(l.a)({},n),{},{rank:a,percent:n.count/Math.max(t,1),top:c,myAnswer:r===n.answer})))}),{}),[e.map((function(e){return Object(l.a)({answer:e},a[e])})),t,s]}),[r,n,c,I]),L=Object(f.a)(q,3),E=L[0],R=L[1],D=L[2],F=Object(O.d)(p),H=Object(m.a)(),J=Object(f.a)(H,2),P=J[0],K=J[1];return Object(a.useLayoutEffect)((function(){F(K.width)}),[F,K.width]),Object(w.jsx)("div",{className:T.a.root,ref:P,children:Object(w.jsxs)("div",{className:T.a.inner,children:[Object(w.jsx)("h1",{className:T.a.title,children:Object(w.jsx)(B,{text:t})}),Object(w.jsxs)("div",{className:T.a.total_count,children:["\uc804\uccb4 ",R,"\uba85"]}),Object(w.jsx)("div",{className:T.a.answers,style:{height:D},children:E.map((function(e,t){return Object(w.jsx)(z,{data:e,onClick:function(){s(e.answer)}},t)}))}),Object(w.jsx)("form",{onSubmit:C,children:Object(w.jsxs)("div",{className:T.a.input_wrap,children:[Object(w.jsx)(M.a,{type:"text",size:"large",onChange:function(e){_(e.target.value.trim())},placeholder:"\ucd94\uac00 \uc758\uacac\uc744 \ub0a8\uaca8\uc8fc\uc138\uc694.",allowClear:!0},N),Object(w.jsx)(o.a,{size:"large",type:"primary",htmlType:"submit",disabled:g,children:"\ud655\uc778"})]})})]})})}var R=function(){return Object(w.jsx)(O.a,{children:Object(w.jsx)(E,{})})},D=n(35),F=n(79),H=n.n(F);var J=function(e){var t=Object(a.useContext)(v).database,n=Object(a.useState)(""),c=Object(f.a)(n,2),r=c[0],s=c[1],i=Object(a.useState)([]),u=Object(f.a)(i,2),j=u[0],O=u[1],m=Object(a.useRef)(0),p=Object(a.useMemo)((function(){return 0===j.filter((function(e){return!e})).length?[].concat(Object(D.a)(j),[{seq:m.current++,value:""}]):j}),[j,m]),h=Object(a.useMemo)((function(){return{question:r,answers:j.map((function(e){return e.value})).filter(Boolean).filter((function(e,t,n){return n.indexOf(e)===t}))}}),[r,j]),x=function(){var e=Object(d.a)(b.a.mark((function e(n){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,null===t||void 0===t?void 0:t.ref("/current-survey").set(Object(l.a)(Object(l.a)({},h),{},{createdAt:(new Date).toISOString()}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsx)("div",{className:H.a.root,children:Object(w.jsxs)("form",{onSubmit:x,children:[Object(w.jsx)(M.a,{type:"text",onChange:function(e){s(e.target.value.trim())},addonBefore:"Q",size:"large"}),p.map((function(e,t){return Object(w.jsx)("div",{children:Object(w.jsx)(M.a.Group,{compact:!0,children:Object(w.jsx)(M.a,{type:"text",onChange:function(n){O((function(a){return[].concat(Object(D.a)(a.slice(0,t)),[{seq:e.seq,value:n.target.value.trim()}],Object(D.a)(a.slice(t+1)))}))},addonBefore:t+1,size:"large"})})},e.seq)})),Object(w.jsx)(o.a,{type:"primary",size:"large",htmlType:"submit",disabled:!(h.question&&h.answers.length>1),block:!0,children:"submit"})]})})},P=n(80),K=n.n(P),Q=n(81),G=n.n(Q);var W=function(){var e=window.location.href.replace(/&admin/,"").replace(/\?admin$/,"").replace(/\?admin/,"?");return Object(w.jsx)("div",{className:G.a.root,children:Object(w.jsx)(K.a,{value:e})})},U=n(58),Y=n.n(U);var Z=function(){return Object(w.jsx)("div",{className:"container",children:Object(w.jsxs)("div",{className:Y.a.root,children:[Object(w.jsx)(R,{}),Object(w.jsx)(i.a,{destroyTooltipOnHide:!0,placement:"bottomRight",content:Object(w.jsx)(W,{}),trigger:"click",children:Object(w.jsx)(o.a,{type:"link",className:Y.a.qrcode,children:Object(w.jsx)("i",{className:"material-icons",children:"qr_code_2"})})}),window.location.search&&Object(w.jsx)(i.a,{destroyTooltipOnHide:!0,placement:"topRight",content:Object(w.jsx)(J,{}),trigger:"click",children:Object(w.jsx)(o.a,{type:"link",className:Y.a.cog,children:Object(w.jsx)("i",{className:"material-icons",children:"settings"})})})]})})},$=n(85),V=(n(106),n(86));var X=function(e){var t=e.children,n=Object(a.useState)(),c=Object(f.a)(n,2),r=c[0],s=c[1],i=Object(a.useState)((function(){var e=localStorage.getItem("user-id");return e||(e=Math.random().toString(36).substr(-8),localStorage.setItem("user-id",e)),e})),o=Object(f.a)(i,1)[0];return Object(a.useEffect)((function(){var e=$.a.initializeApp(V.firebase);s(e.database())}),[]),r?Object(w.jsx)(v.Provider,{value:{database:r,userId:o},children:t}):null};var ee=function(){return Object(w.jsx)(X,{children:Object(w.jsx)(Z,{})})},te=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,115)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),r(e),s(e)}))};s.a.render(Object(w.jsx)(c.a.StrictMode,{children:Object(w.jsx)(ee,{})}),document.getElementById("root")),te()},30:function(e,t,n){e.exports={root:"Answer_root__2pq4A",animate:"Answer_animate__3cNGN",button:"Answer_button__3llNr",bar:"Answer_bar__CHkP2",item:"Answer_item__3bULz",my:"Answer_my__RC-Cs",answer:"Answer_answer__3QepJ",count:"Answer_count__3DShc"}},39:function(e,t,n){e.exports={root:"InstantSurvey_root__1vFpt",inner:"InstantSurvey_inner__2F1OO",title:"InstantSurvey_title__3RpJq",answers:"InstantSurvey_answers__1ZJMl",total_count:"InstantSurvey_total_count__2kmka",input_wrap:"InstantSurvey_input_wrap__1aN55"}},58:function(e,t,n){e.exports={qrcode:"Main_qrcode__30a1k",cog:"Main_cog__1wdKd"}},61:function(e,t,n){e.exports={root:"ResponsiveText_root__1Ds0_",dummy:"ResponsiveText_dummy__1f85y"}},79:function(e,t,n){e.exports={root:"AddSurvey_root__3IKt1",item:"AddSurvey_item__35jFS"}},81:function(e,t,n){e.exports={root:"SiteUrlQrCode_root__9zKH5"}},86:function(e){e.exports=JSON.parse('{"firebase":{"apiKey":"AIzaSyDS1mhNTsLekzQB7t1q3E52G8Wy4sDiSA4","authDomain":"instant-survey-f7f4c.firebaseapp.com","projectId":"instant-survey-f7f4c","storageBucket":"instant-survey-f7f4c.appspot.com","messagingSenderId":"934201169374","appId":"1:934201169374:web:3f8744be20f5ca255cf94f"}}')},95:function(e,t,n){}},[[110,1,2]]]);
//# sourceMappingURL=main.3b148f81.chunk.js.map